# [WIP]句末分号：你可能不了解的事实

​	在讲述接下里的故事之前，话不多说，让我们先来做一道题练练手。

​	请思考下列JS语句输出结果是什么？并复制粘贴进**浏览器控制台**中运行验证。

```js
let foo=[[1,2,3],[4,5,6],[7,8,9]]
let bar=foo
[1,2,1,2,1,2].forEach(item=>console.log(item))
```

​	如果输出和你预期中的一样，那么恭喜你，你的JS基础非常扎实。

​	如果输出与你预期中的不一样，不用灰心，大多数的我们都和你是一样的预期，这个时候你可以把这段代码复制进你的JS文件中保存，然后再用Node环境去运行这个JS文件，输出可能又和你最开始的预期一样。造成这种输出的不同，并不是Node环境和浏览器运行环境的不同，而是可能你在**Vscode**保存时**Eslint**帮你悄悄加上了分号。

```js
//Let‘s say it together Thank you Eslint!!!
let foo=[[1,2,3],[4,5,6],[7,8,9]];
let bar=foo;
[1,2,1,2,1,2].forEach(item=>console.log(item));
```

​	上面的题其实包含了两个小知识，**自动分号补全**和**逗号操作符**。

> Tips: 以下的两个知识点的标题和相关引用均有超链接跳转，可点击跳转原文

## [自动分号补全](https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Lexical_grammar#自动分号补全)（[Automatic Semicolon Insertion](https://262.ecma-international.org/11.0/#sec-automatic-semicolon-insertion)）

当你没有句末分号的时候，JS解析器会尽量把新的一行纳入当前行解释，只有符合**自动分号补全**规则才会在合适的位置自动补全分号，警惕句首以   **[ ( \\ +  - ** 这五种特殊字符开头,这时候可能会被当做上一行的一部分来解析。

> 1. 当新的一行并入当前行将构成非法语句不能正确解析时，将自动插入分号
> 1. 当新行以 **}** 开头时，即代码块的结束位置，将自动插入分号
> 1. 当以**return**语句结束时, 在行末自动插入分号
> 1. 当以**break**语句结束时, 在行末自动插入分号
> 1. 当以**throw**语句结束时,在行末自动插入分号
> 1. 当以**continue**语句结束时, 在行末自动插入分号
> 1. 当以 ES6 的 **yield** 语句结尾时，在行末自动插入分号
> 1. **++**、**--** 后缀表达式作为新行的开始，在行首自动插入分号
> 1. 源代码文件末尾自动插入号
>
> ​                                                                                                                              --以上规则引用自[JS分号的一些细节](https://www.cnblogs.com/vickylinj/p/15511064.html)



```js
/*eg*/
let       //当JS读到这行时并不会停止，而是继续往下
foo='foo' //到这行的时候，组成let foo = 'foo' 一句完整语句，进行自动分号补全，然后继续往下解析
let bar='bar'
/*等同于*/
let foo = 'foo'
let bar = 'bar'
```

​    这个时候回头看第一个例子会发现代码会被这么解释

```js
let foo=[[1,2,3],[4,5,6],[7,8,9]]
let bar=foo
[1,2,1,2,1,2].forEach(item=>console.log(item))
/*等同于*/
let foo=[[1,2,3],[4,5,6],[7,8,9]]
let bar=foo[1,2,1,2,1,2].forEach(item=>console.log(item))
//即:[[1,2,3],[4,5,6],[7,8,9]][1,2,1,2,1,2].forEach(item=>console.log(item))
```

​	简单了解完**自动分号补全**机制可以跳转第二个知识点：**逗号操作符**

## [逗号操作符](https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Operators/Comma_Operator) （[Comma Operator](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Comma_Operator)）

> **逗号操作符** 对它的每个操作数求值（从左到右），并返回最后一个操作数的值。  --MDN

请在控制台中输入如下的例子帮助理解

```js
(1,2,3,4,5) 			// output:5 返回逗号分隔的最后一个数5
[2,4,6,8,10][0]		// output:2 这个很容易理解，数组的index为0的位置是2
[2,4,6,8,10][0,1]	// output:4 前一个中括号包裹的是数组,后一个为访问数组属性下标 0,1返回1,最终输出 4
```

当你两个数组字面量连在一起的时候，后一个会被当做数组的属性访问来解释。

两个知识点结合起来之后，我们就可以明白第一个例子到底发生了什么。

```js
// 第一个例子的最终解释版本
// 即:[[1,2,3],[4,5,6],[7,8,9]][1,2,1,2,1,2].forEach(item=>console.log(item))
// 即:[[1,2,3],[4,5,6],[7,8,9]][2].forEach(item=>console.log(item))
// 即:[7,8,9].forEach(item=>console.log(item))
```

## 其他的例子

TODO



前置分号 

## 规避措施

​	正如4个空格和2个空格缩进在互联网喋喋不休的时候，加不加分号也在前端的圈子里引发过无数的争论，

